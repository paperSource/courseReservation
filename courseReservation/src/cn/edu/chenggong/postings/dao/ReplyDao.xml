<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="cn.edu.chenggong.postings.dao.ReplyDao">
	<insert id="add" parameterType="cn.edu.chenggong.postings.model.Reply">
		insert into Reply(TopicID,replyID,date,content,flowers,eggs,state,EXT1,EXT2,EXT3,EXT4,EXT5)
		values(#{TopicID},#{replyID},sysdate(),#{content},#{flowers},#{eggs},#{state},#{EXT1},#{EXT2},#{EXT3},#{EXT4},#{EXT5})
	</insert>
	<delete id="delete" parameterType="int">
		delete from Reply where id = #{id}
	</delete>
	<select id="queryByID" parameterType="int" resultType="cn.edu.chenggong.postings.model.Reply">
		select id,TopicID,replyID,date,content,flowers,eggs,state,EXT1,EXT2,EXT3,EXT4,EXT5
		from Reply where state=1 and id = #{id}
	</select>
	<select id="queryByUID" parameterType="int" resultType="cn.edu.chenggong.postings.model.Reply">
		select id,TopicID,replyID,date,content,flowers,eggs,state,EXT1,EXT2,EXT3,EXT4,EXT5
		from Reply where state=1 and replyID = #{uid}
	</select>
	<select id="queryByUTid" resultType="cn.edu.chenggong.postings.model.Reply">
		select id,TopicID,replyID,date,content,flowers,eggs,state,EXT1,EXT2,EXT3,EXT4,EXT5
		from Reply where state=1 and replyID = #{0} and TopicID = #{1}
	</select>
	<select id="queryByTopicIDList" parameterType="int" resultType="cn.edu.chenggong.postings.model.Reply">
		select id,TopicID,replyID,date,content,flowers,eggs,state,EXT1,EXT2,EXT3,EXT4,EXT5
		from Reply where state=1 and TopicID = #{tid} order by date asc
	</select>
	<select id="queryByTopicID" parameterType="map" resultType="cn.edu.chenggong.postings.model.Reply">
		select id,TopicID,replyID,date,content,flowers,eggs,state,EXT1,EXT2,EXT3,EXT4,EXT5
		from Reply where state=1 and TopicID = #{tid} order by date asc limit #{start},#{number}
	</select>
	<update id="addFlowers" parameterType="int">
		UPDATE reply set flowers=flowers+1 where id = #{id}
	</update>
	<update id="addEggs" parameterType="int">
		UPDATE reply set eggs=eggs+1 where id = #{id}
	</update>
</mapper>
